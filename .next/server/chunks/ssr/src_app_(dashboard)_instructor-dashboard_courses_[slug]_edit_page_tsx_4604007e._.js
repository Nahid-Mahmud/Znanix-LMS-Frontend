module.exports=[364056,a=>{"use strict";a.s(["default",()=>y]);var b=a.i(669720),c=a.i(674045),d=a.i(699570),e=a.i(591119),f=a.i(975612),g=a.i(441921),h=a.i(866718),i=a.i(582975),j=a.i(580701),k=a.i(333140),l=a.i(429246),m=a.i(712944),n=a.i(765749),o=a.i(666298),p=a.i(688774),q=a.i(491163),r=a.i(702485),s=a.i(229611),t=a.i(39457),u=a.i(95811),v=a.i(90987),w=function(a){return a.PAID="PAID",a.FREE="FREE",a}(w||{});let x=v.z.object({name:v.z.string().min(2,{message:"Course name must be at least 2 characters."}),description:v.z.string().min(10,{message:"Description must be at least 10 characters."}),price:v.z.number().min(0,{message:"Price must be 0 or greater."}),courseDuration:v.z.number().min(0,{message:"Course duration is required"}),type:v.z.nativeEnum(w),certificate:v.z.boolean(),tags:v.z.string().min(1,{message:"Please add at least one tag."}).refine(a=>a.split(",").map(a=>a.trim()).filter(a=>a.length>0).length<=5,{message:"Please provide at most 5 tags.",path:["tags"]}),thumbnail:v.z.string().optional(),introVideo:v.z.string().optional(),discount:v.z.number().min(0).max(100).optional(),longDescription:v.z.string("Long description is required").min(20,"Long description must be at least 20 characters long").max(1e4,"Long description must be at most 5000 characters long")}).refine(a=>"PAID"!==a.type||!(a.price<=0),{message:"Paid courses must have a price greater than 0.",path:["price"]});function y(){let a=(0,r.useParams)(),v=(0,r.useRouter)(),w=a.slug,[y,z]=(0,s.useState)([]),[A,B]=(0,s.useState)([]),[C,D]=(0,s.useState)([]),[E,F]=(0,s.useState)(!1),{data:G,isLoading:H}=(0,m.useGetCoursesDetailBySlugQuery)(w,{skip:!w});console.log("Course Data:",G);let[I,{isLoading:J}]=(0,m.useUpdateCourseMutation)(),K=a=>{a.length>0&&G?.data?.thumbnail&&0===A.length&&z(a=>[...a,G.data.thumbnail]),B(a),M.setValue("thumbnail",a.length>0?a[0].file.name:""),M.trigger("thumbnail")},L=a=>{a.length>0&&G?.data?.introVideo&&0===C.length&&z(a=>[...a,G.data.introVideo]),D(a),M.setValue("introVideo",a.length>0?a[0].file.name:""),M.trigger("introVideo")},M=(0,t.useForm)({resolver:(0,n.zodResolver)(x),defaultValues:{name:"",description:"",price:0,courseDuration:0,type:"PAID",certificate:!1,tags:"",thumbnail:"",introVideo:"",discount:0,longDescription:""}}),N=M.watch("type");(0,s.useEffect)(()=>{"FREE"===N&&M.setValue("price",0)},[N,M]),(0,s.useEffect)(()=>{if(G?.data&&!E){let a=G.data;console.log("Updating form with course data:",a);let b={name:a.name||"",description:a.description||"",price:a.price||0,courseDuration:parseInt(a.courseDuration)||0,type:a.type||"PAID",certificate:a.certificate||!1,tags:Array.isArray(a.tags)?a.tags.join(", "):"",thumbnail:a.thumbnail||"",introVideo:a.introVideo||"",discount:a.discount||0,longDescription:a.longDescription||""};console.log("Form data to set:",b),M.reset(b),F(!0)}},[G,M,E]);let O=async a=>{try{let b=a.tags.split(",").map(a=>a.trim()).filter(a=>a.length>0),c={...a,tags:b,price:"FREE"===a.type?0:a.price,deletedFiles:y},d=new FormData;d.append("data",JSON.stringify(c)),A[0]?.file instanceof File&&d.append("thumbnail",A[0].file),C[0]?.file instanceof File&&d.append("introVideo",C[0].file),console.log("Deleted files to be processed:",y),(await I({id:G?.data._id,data:d}).unwrap()).success&&(u.toast.success("Course updated successfully!",{description:`Your course "${a.name}" has been updated.`}),z([]),v.push(`/instructor-dashboard/courses/${w}`))}catch(a){u.toast.error("Failed to update course. Please try again."),console.log(a)}};return H?(0,b.jsx)("div",{className:"min-h-screen bg-background p-6",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(k.Skeleton,{className:"h-10 w-20"}),(0,b.jsxs)("div",{children:[(0,b.jsx)(k.Skeleton,{className:"h-8 w-48 mb-2"}),(0,b.jsx)(k.Skeleton,{className:"h-4 w-32"})]})]})}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(k.Skeleton,{className:"h-6 w-32"})}),(0,b.jsx)(e.CardContent,{className:"space-y-6",children:[...Array(8)].map((a,c)=>(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.Skeleton,{className:"h-4 w-24"}),(0,b.jsx)(k.Skeleton,{className:"h-10 w-full"})]},c))})]})]})}):G?(0,b.jsx)("div",{className:"min-h-screen bg-background p-6",children:(0,b.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,b.jsx)("div",{className:"flex items-center justify-between",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)(d.Button,{variant:"ghost",onClick:()=>v.back(),children:[(0,b.jsx)(o.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back"]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold",children:"Edit Course"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Update your course information"})]})]})}),(0,b.jsxs)(e.Card,{children:[(0,b.jsx)(e.CardHeader,{children:(0,b.jsx)(e.CardTitle,{children:"Course Information"})}),(0,b.jsx)(e.CardContent,{children:(0,b.jsx)(g.Form,{...M,children:(0,b.jsxs)("form",{onSubmit:M.handleSubmit(O),className:"space-y-6",children:[(0,b.jsx)(g.FormField,{control:M.control,name:"name",render:({field:a})=>(0,b.jsxs)(g.FormItem,{children:[(0,b.jsx)(g.FormLabel,{children:"Course Name *"}),(0,b.jsx)(g.FormControl,{children:(0,b.jsx)(h.Input,{placeholder:"Enter course name",...a})}),(0,b.jsx)(g.FormMessage,{})]})}),(0,b.jsx)(g.FormField,{control:M.control,name:"description",render:({field:a})=>(0,b.jsxs)(g.FormItem,{children:[(0,b.jsx)(g.FormLabel,{children:"Short Description *"}),(0,b.jsx)(g.FormControl,{children:(0,b.jsx)(l.Textarea,{placeholder:"Describe your course within one or two sentences",className:"min-h-[120px]",...a})}),(0,b.jsx)(g.FormMessage,{})]})}),(0,b.jsx)(g.FormField,{control:M.control,name:"longDescription",render:({field:a})=>(0,b.jsxs)(g.FormItem,{children:[(0,b.jsx)(g.FormLabel,{children:"Long Description *"}),(0,b.jsx)(g.FormControl,{children:E?(0,b.jsx)(i.MDXEditor,{value:a.value||"",onChange:a.onChange,onBlur:a.onBlur,name:a.name,placeholder:"Write a detailed description of your course using markdown. You can format text, add headings, lists, links, and more...",className:"min-h-[200px]",showPreview:!0},`mdx-${G?.data?._id}`):(0,b.jsx)("div",{className:"min-h-[200px] border rounded-md flex items-center justify-center",children:(0,b.jsx)("span",{className:"text-muted-foreground",children:"Loading editor..."})})}),(0,b.jsx)(g.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(g.FormField,{control:M.control,name:"type",render:({field:a})=>(0,b.jsxs)(g.FormItem,{children:[(0,b.jsx)(g.FormLabel,{children:"Course Type *"}),(0,b.jsxs)(j.Select,{onValueChange:a.onChange,defaultValue:a.value,children:[(0,b.jsx)(g.FormControl,{children:(0,b.jsx)(j.SelectTrigger,{className:"w-full",children:(0,b.jsx)(j.SelectValue,{placeholder:"Select course type"})})}),(0,b.jsxs)(j.SelectContent,{children:[(0,b.jsx)(j.SelectItem,{value:"PAID",children:"Paid"}),(0,b.jsx)(j.SelectItem,{value:"FREE",children:"Free"})]})]}),(0,b.jsx)(g.FormMessage,{})]})}),(0,b.jsx)(g.FormField,{control:M.control,name:"price",render:({field:a})=>(0,b.jsxs)(g.FormItem,{children:[(0,b.jsx)(g.FormLabel,{children:"Price (BDT) *"}),(0,b.jsx)(g.FormControl,{children:(0,b.jsx)(h.Input,{type:"number",placeholder:"0.00",...a,disabled:"FREE"===N,onChange:b=>a.onChange(parseFloat(b.target.value)||0)})}),(0,b.jsx)(g.FormMessage,{})]})})]}),(0,b.jsx)(g.FormField,{control:M.control,name:"courseDuration",render:({field:a})=>(0,b.jsxs)(g.FormItem,{children:[(0,b.jsx)(g.FormLabel,{children:"Course Duration"}),(0,b.jsx)(g.FormControl,{children:(0,b.jsx)(h.Input,{type:"number",placeholder:"e.g., 8 weeks, 20 hours",...a,onChange:b=>a.onChange(parseFloat(b.target.value)||0)})}),(0,b.jsx)(g.FormMessage,{})]})}),(0,b.jsx)(g.FormField,{control:M.control,name:"tags",render:({field:a})=>(0,b.jsxs)(g.FormItem,{children:[(0,b.jsx)(g.FormLabel,{children:"Tags *"}),(0,b.jsx)(g.FormControl,{children:(0,b.jsx)(h.Input,{placeholder:"Enter up to 5 tags separated by commas (e.g., web development, react, javascript)",...a})}),(0,b.jsx)(g.FormMessage,{})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,b.jsx)(g.FormField,{control:M.control,name:"thumbnail",render:({field:a})=>(0,b.jsxs)(g.FormItem,{children:[(0,b.jsx)(g.FormLabel,{children:"Course Thumbnail"}),(0,b.jsx)(g.FormControl,{children:(0,b.jsx)("div",{children:(0,b.jsx)(c.default,{maxSize:0x1400000,accept:"image/*",onFilesChange:K,placeholder:"Upload thumbnail image"})})}),(0,b.jsx)(g.FormMessage,{}),0===A.length&&G?.data?.thumbnail&&!y.includes(G?.data?.thumbnail||"")&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Current thumbnail will be preserved if not changed"}),y.includes(G?.data?.thumbnail||"")&&(0,b.jsx)("p",{className:"text-sm text-red-600",children:"Current thumbnail will be deleted"})]})}),(0,b.jsx)(g.FormField,{control:M.control,name:"introVideo",render:({field:a})=>(0,b.jsxs)(g.FormItem,{children:[(0,b.jsx)(g.FormLabel,{children:"Intro Video"}),(0,b.jsx)(g.FormControl,{children:(0,b.jsx)("div",{children:(0,b.jsx)(c.default,{maxSize:0x1400000,accept:"video/*",onFilesChange:L,placeholder:"Upload intro video"})})}),(0,b.jsx)(g.FormMessage,{}),0===C.length&&G?.data?.introVideo&&!y.includes(G?.data?.introVideo||"")&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Current intro video will be preserved if not changed"}),y.includes(G?.data?.introVideo||"")&&(0,b.jsx)("p",{className:"text-sm text-red-600",children:"Current intro video will be deleted"})]})})]}),(0,b.jsx)("div",{className:"flex flex-col space-y-4",children:(0,b.jsx)(g.FormField,{control:M.control,name:"certificate",render:({field:a})=>(0,b.jsxs)(g.FormItem,{className:"flex flex-row items-start space-x-3 space-y-0",children:[(0,b.jsx)(g.FormControl,{children:(0,b.jsx)(f.Checkbox,{checked:a.value,onCheckedChange:a.onChange})}),(0,b.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,b.jsx)(g.FormLabel,{children:"Certificate Available"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Students will receive a certificate upon completion"})]})]})})}),(0,b.jsxs)("div",{className:"flex justify-end space-x-2 pt-4",children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>v.back(),children:"Cancel"}),(0,b.jsx)(d.Button,{type:"submit",disabled:J,children:J?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q.Save,{className:"w-4 h-4 mr-2"}),"Update Course"]})})]})]})})})]})]})}):(0,b.jsx)("div",{children:"Course not found"})}}];

//# sourceMappingURL=src_app_%28dashboard%29_instructor-dashboard_courses_%5Bslug%5D_edit_page_tsx_4604007e._.js.map