module.exports=[467430,a=>{"use strict";a.s(["commonmarkLanguage",()=>aN,"deleteMarkupBackward",()=>aX,"insertNewlineContinueMarkup",()=>aU,"markdown",()=>a$,"markdownKeymap",()=>aY,"markdownLanguage",()=>aO],467430);var b,c=a.i(585184),d=a.i(555669),e=a.i(27312),f=a.i(851878),g=a.i(62036),h=a.i(439262);class i{static create(a,b,c,d,e){return new i(a,b,c,d+(d<<8)+a+(b<<4)|0,e,[],[])}constructor(a,b,c,d,e,f,h){this.type=a,this.value=b,this.from=c,this.hash=d,this.end=e,this.children=f,this.positions=h,this.hashProp=[[g.NodeProp.contextHash,d]]}addChild(a,b){a.prop(g.NodeProp.contextHash)!=this.hash&&(a=new g.Tree(a.type,a.children,a.positions,a.length,this.hashProp)),this.children.push(a),this.positions.push(b)}toTree(a,b=this.end){let c=this.children.length-1;return c>=0&&(b=Math.max(b,this.positions[c]+this.children[c].length+this.from)),new g.Tree(a.types[this.type],this.children,this.positions,b-this.from).balance({makeTree:(a,b,c)=>new g.Tree(g.NodeType.none,a,b,c,this.hashProp)})}}!function(a){a[a.Document=1]="Document",a[a.CodeBlock=2]="CodeBlock",a[a.FencedCode=3]="FencedCode",a[a.Blockquote=4]="Blockquote",a[a.HorizontalRule=5]="HorizontalRule",a[a.BulletList=6]="BulletList",a[a.OrderedList=7]="OrderedList",a[a.ListItem=8]="ListItem",a[a.ATXHeading1=9]="ATXHeading1",a[a.ATXHeading2=10]="ATXHeading2",a[a.ATXHeading3=11]="ATXHeading3",a[a.ATXHeading4=12]="ATXHeading4",a[a.ATXHeading5=13]="ATXHeading5",a[a.ATXHeading6=14]="ATXHeading6",a[a.SetextHeading1=15]="SetextHeading1",a[a.SetextHeading2=16]="SetextHeading2",a[a.HTMLBlock=17]="HTMLBlock",a[a.LinkReference=18]="LinkReference",a[a.Paragraph=19]="Paragraph",a[a.CommentBlock=20]="CommentBlock",a[a.ProcessingInstructionBlock=21]="ProcessingInstructionBlock",a[a.Escape=22]="Escape",a[a.Entity=23]="Entity",a[a.HardBreak=24]="HardBreak",a[a.Emphasis=25]="Emphasis",a[a.StrongEmphasis=26]="StrongEmphasis",a[a.Link=27]="Link",a[a.Image=28]="Image",a[a.InlineCode=29]="InlineCode",a[a.HTMLTag=30]="HTMLTag",a[a.Comment=31]="Comment",a[a.ProcessingInstruction=32]="ProcessingInstruction",a[a.Autolink=33]="Autolink",a[a.HeaderMark=34]="HeaderMark",a[a.QuoteMark=35]="QuoteMark",a[a.ListMark=36]="ListMark",a[a.LinkMark=37]="LinkMark",a[a.EmphasisMark=38]="EmphasisMark",a[a.CodeMark=39]="CodeMark",a[a.CodeText=40]="CodeText",a[a.CodeInfo=41]="CodeInfo",a[a.LinkTitle=42]="LinkTitle",a[a.LinkLabel=43]="LinkLabel",a[a.URL=44]="URL"}(b||(b={}));class j{constructor(a,b){this.start=a,this.content=b,this.marks=[],this.parsers=[]}}class k{constructor(){this.text="",this.baseIndent=0,this.basePos=0,this.depth=0,this.markers=[],this.pos=0,this.indent=0,this.next=-1}forward(){this.basePos>this.pos&&this.forwardInner()}forwardInner(){let a=this.skipSpace(this.basePos);this.indent=this.countIndent(a,this.pos,this.indent),this.pos=a,this.next=a==this.text.length?-1:this.text.charCodeAt(a)}skipSpace(a){return o(this.text,a)}reset(a){for(this.text=a,this.baseIndent=this.basePos=this.pos=this.indent=0,this.forwardInner(),this.depth=1;this.markers.length;)this.markers.pop()}moveBase(a){this.basePos=a,this.baseIndent=this.countIndent(a,this.pos,this.indent)}moveBaseColumn(a){this.baseIndent=a,this.basePos=this.findColumn(a)}addMarker(a){this.markers.push(a)}countIndent(a,b=0,c=0){for(let d=b;d<a;d++)c+=9==this.text.charCodeAt(d)?4-c%4:1;return c}findColumn(a){let b=0;for(let c=0;b<this.text.length&&c<a;b++)c+=9==this.text.charCodeAt(b)?4-c%4:1;return b}scrub(){if(!this.baseIndent)return this.text;let a="";for(let b=0;b<this.basePos;b++)a+=" ";return a+this.text.slice(this.basePos)}}function l(a,c,d){if(d.pos==d.text.length||a!=c.block&&d.indent>=c.stack[d.depth+1].value+d.baseIndent)return!0;if(d.indent>=d.baseIndent+4)return!1;let e=(a.type==b.OrderedList?v:u)(d,c,!1);return e>0&&(a.type!=b.BulletList||0>s(d,c,!1))&&d.text.charCodeAt(d.pos+e-1)==a.value}let m={[b.Blockquote]:(a,c,d)=>62==d.next&&(d.markers.push(U(b.QuoteMark,c.lineStart+d.pos,c.lineStart+d.pos+1)),d.moveBase(d.pos+(n(d.text.charCodeAt(d.pos+1))?2:1)),a.end=c.lineStart+d.text.length,!0),[b.ListItem]:(a,b,c)=>(!(c.indent<c.baseIndent+a.value)||!(c.next>-1))&&(c.moveBaseColumn(c.baseIndent+a.value),!0),[b.OrderedList]:l,[b.BulletList]:l,[b.Document]:()=>!0};function n(a){return 32==a||9==a||10==a||13==a}function o(a,b=0){for(;b<a.length&&n(a.charCodeAt(b));)b++;return b}function p(a,b,c){for(;b>c&&n(a.charCodeAt(b-1));)b--;return b}function q(a){if(96!=a.next&&126!=a.next)return -1;let b=a.pos+1;for(;b<a.text.length&&a.text.charCodeAt(b)==a.next;)b++;if(b<a.pos+3)return -1;if(96==a.next){for(let c=b;c<a.text.length;c++)if(96==a.text.charCodeAt(c))return -1}return b}function r(a){return 62!=a.next?-1:32==a.text.charCodeAt(a.pos+1)?2:1}function s(a,b,c){if(42!=a.next&&45!=a.next&&95!=a.next)return -1;let d=1;for(let b=a.pos+1;b<a.text.length;b++){let c=a.text.charCodeAt(b);if(c==a.next)d++;else if(!n(c))return -1}return c&&45==a.next&&x(a)>-1&&a.depth==b.stack.length&&b.parser.leafBlockParsers.indexOf(J.SetextHeading)>-1||d<3?-1:1}function t(a,b){for(let c=a.stack.length-1;c>=0;c--)if(a.stack[c].type==b)return!0;return!1}function u(a,c,d){return(45==a.next||43==a.next||42==a.next)&&(a.pos==a.text.length-1||n(a.text.charCodeAt(a.pos+1)))&&(!d||t(c,b.BulletList)||a.skipSpace(a.pos+2)<a.text.length)?1:-1}function v(a,c,d){let e=a.pos,f=a.next;for(;f>=48&&f<=57;){if(++e==a.text.length)return -1;f=a.text.charCodeAt(e)}return e==a.pos||e>a.pos+9||46!=f&&41!=f||e<a.text.length-1&&!n(a.text.charCodeAt(e+1))||d&&!t(c,b.OrderedList)&&(a.skipSpace(e+1)==a.text.length||e>a.pos+1||49!=a.next)?-1:e+1-a.pos}function w(a){if(35!=a.next)return -1;let b=a.pos+1;for(;b<a.text.length&&35==a.text.charCodeAt(b);)b++;if(b<a.text.length&&32!=a.text.charCodeAt(b))return -1;let c=b-a.pos;return c>6?-1:c}function x(a){if(45!=a.next&&61!=a.next||a.indent>=a.baseIndent+4)return -1;let b=a.pos+1;for(;b<a.text.length&&a.text.charCodeAt(b)==a.next;)b++;let c=b;for(;b<a.text.length&&n(a.text.charCodeAt(b));)b++;return b==a.text.length?c:-1}let y=/^[ \t]*$/,z=/-->/,A=/\?>/,B=[[/^<(?:script|pre|style)(?:\s|>|$)/i,/<\/(?:script|pre|style)>/i],[/^\s*<!--/,z],[/^\s*<\?/,A],[/^\s*<![A-Z]/,/>/],[/^\s*<!\[CDATA\[/,/\]\]>/],[/^\s*<\/?(?:address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h1|h2|h3|h4|h5|h6|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul)(?:\s|\/?>|$)/i,y],[/^\s*(?:<\/[a-z][\w-]*\s*>|<[a-z][\w-]*(\s+[a-z:_][\w-.]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*>)\s*$/i,y]];function C(a,b,c){if(60!=a.next)return -1;let d=a.text.slice(a.pos);for(let a=0,b=B.length-!!c;a<b;a++)if(B[a][0].test(d))return a;return -1}function D(a,b){let c=a.countIndent(b,a.pos,a.indent),d=a.countIndent(a.skipSpace(b),b,c);return d>=c+5?c+1:d}function E(a,c,d){let e=a.length-1;e>=0&&a[e].to==c&&a[e].type==b.CodeText?a[e].to=d:a.push(U(b.CodeText,c,d))}let F={LinkReference:void 0,IndentedCode(a,c){let d=c.baseIndent+4;if(c.indent<d)return!1;let e=c.findColumn(d),f=a.lineStart+e,g=a.lineStart+c.text.length,h=[],i=[];for(E(h,f,g);a.nextLine()&&c.depth>=a.stack.length;)if(c.pos==c.text.length)for(let b of(E(i,a.lineStart-1,a.lineStart),c.markers))i.push(b);else if(c.indent<d)break;else{if(i.length){for(let a of i)a.type==b.CodeText?E(h,a.from,a.to):h.push(a);i=[]}for(let b of(E(h,a.lineStart-1,a.lineStart),c.markers))h.push(b);g=a.lineStart+c.text.length;let d=a.lineStart+c.findColumn(c.baseIndent+4);d<g&&E(h,d,g)}return i.length&&(i=i.filter(a=>a.type!=b.CodeText)).length&&(c.markers=i.concat(c.markers)),a.addNode(a.buffer.writeElements(h,-f).finish(b.CodeBlock,g-f),f),!0},FencedCode(a,c){let d=q(c);if(d<0)return!1;let e=a.lineStart+c.pos,f=c.next,g=d-c.pos,h=c.skipSpace(d),i=p(c.text,c.text.length,h),j=[U(b.CodeMark,e,e+g)];h<i&&j.push(U(b.CodeInfo,a.lineStart+h,a.lineStart+i));for(let d=!0;a.nextLine()&&c.depth>=a.stack.length;d=!1){let e=c.pos;if(c.indent-c.baseIndent<4)for(;e<c.text.length&&c.text.charCodeAt(e)==f;)e++;if(e-c.pos>=g&&c.skipSpace(e)==c.text.length){for(let a of c.markers)j.push(a);j.push(U(b.CodeMark,a.lineStart+c.pos,a.lineStart+e)),a.nextLine();break}{for(let b of(d||E(j,a.lineStart-1,a.lineStart),c.markers))j.push(b);let b=a.lineStart+c.basePos,e=a.lineStart+c.text.length;b<e&&E(j,b,e)}}return a.addNode(a.buffer.writeElements(j,-e).finish(b.FencedCode,a.prevLineEnd()-e),e),!0},Blockquote(a,c){let d=r(c);return!(d<0)&&(a.startContext(b.Blockquote,c.pos),a.addNode(b.QuoteMark,a.lineStart+c.pos,a.lineStart+c.pos+1),c.moveBase(c.pos+d),null)},HorizontalRule(a,c){if(0>s(c,a,!1))return!1;let d=a.lineStart+c.pos;return a.nextLine(),a.addNode(b.HorizontalRule,d),!0},BulletList(a,c){let d=u(c,a,!1);if(d<0)return!1;a.block.type!=b.BulletList&&a.startContext(b.BulletList,c.basePos,c.next);let e=D(c,c.pos+1);return a.startContext(b.ListItem,c.basePos,e-c.baseIndent),a.addNode(b.ListMark,a.lineStart+c.pos,a.lineStart+c.pos+d),c.moveBaseColumn(e),null},OrderedList(a,c){let d=v(c,a,!1);if(d<0)return!1;a.block.type!=b.OrderedList&&a.startContext(b.OrderedList,c.basePos,c.text.charCodeAt(c.pos+d-1));let e=D(c,c.pos+d);return a.startContext(b.ListItem,c.basePos,e-c.baseIndent),a.addNode(b.ListMark,a.lineStart+c.pos,a.lineStart+c.pos+d),c.moveBaseColumn(e),null},ATXHeading(a,c){let d=w(c);if(d<0)return!1;let e=c.pos,f=a.lineStart+e,g=p(c.text,c.text.length,e),h=g;for(;h>e&&c.text.charCodeAt(h-1)==c.next;)h--;h!=g&&h!=e&&n(c.text.charCodeAt(h-1))||(h=c.text.length);let i=a.buffer.write(b.HeaderMark,0,d).writeElements(a.parser.parseInline(c.text.slice(e+d+1,h),f+d+1),-f);h<c.text.length&&i.write(b.HeaderMark,h-e,g-e);let j=i.finish(b.ATXHeading1-1+d,c.text.length-e);return a.nextLine(),a.addNode(j,f),!0},HTMLBlock(a,c){let d=C(c,a,!1);if(d<0)return!1;let e=a.lineStart+c.pos,f=B[d][1],g=[],h=f!=y;for(;!f.test(c.text)&&a.nextLine();){if(c.depth<a.stack.length){h=!1;break}for(let a of c.markers)g.push(a)}h&&a.nextLine();let i=f==z?b.CommentBlock:f==A?b.ProcessingInstructionBlock:b.HTMLBlock,j=a.prevLineEnd();return a.addNode(a.buffer.writeElements(g,-e).finish(i,j-e),e),!0},SetextHeading:void 0};class G{constructor(a){this.stage=0,this.elts=[],this.pos=0,this.start=a.start,this.advance(a.content)}nextLine(a,b,c){if(-1==this.stage)return!1;let d=c.content+"\n"+b.scrub(),e=this.advance(d);return e>-1&&e<d.length&&this.complete(a,c,e)}finish(a,b){return(2==this.stage||3==this.stage)&&o(b.content,this.pos)==b.content.length&&this.complete(a,b,b.content.length)}complete(a,c,d){return a.addLeafElement(c,U(b.LinkReference,this.start,this.start+d,this.elts)),!0}nextStage(a){return a?(this.pos=a.to-this.start,this.elts.push(a),this.stage++,!0):(!1===a&&(this.stage=-1),!1)}advance(a){for(;;)if(-1==this.stage)return -1;else if(0==this.stage){if(!this.nextStage(ad(a,this.pos,this.start,!0)))return -1;if(58!=a.charCodeAt(this.pos))return this.stage=-1;this.elts.push(U(b.LinkMark,this.pos+this.start,this.pos+this.start+1)),this.pos++}else if(1==this.stage){if(!this.nextStage(ab(a,o(a,this.pos),this.start)))return -1}else{if(2!=this.stage)return H(a,this.pos);let b=o(a,this.pos),c=0;if(b>this.pos){let d=ac(a,b,this.start);if(d){let b=H(a,d.to-this.start);b>0&&(this.nextStage(d),c=b)}}return c||(c=H(a,this.pos)),c>0&&c<a.length?c:-1}}}function H(a,b){for(;b<a.length;b++){let c=a.charCodeAt(b);if(10==c)break;if(!n(c))return -1}return b}class I{nextLine(a,c,d){let e=c.depth<a.stack.length?-1:x(c),f=c.next;if(e<0)return!1;let g=U(b.HeaderMark,a.lineStart+c.pos,a.lineStart+e);return a.nextLine(),a.addLeafElement(d,U(61==f?b.SetextHeading1:b.SetextHeading2,d.start,a.prevLineEnd(),[...a.parser.parseInline(d.content,d.start),g])),!0}finish(){return!1}}let J={LinkReference:(a,b)=>91==b.content.charCodeAt(0)?new G(b):null,SetextHeading:()=>new I},K={text:"",end:0};class L{constructor(a,c,d,e){this.parser=a,this.input=c,this.ranges=e,this.line=new k,this.atEnd=!1,this.reusePlaceholders=new Map,this.stoppedAt=null,this.rangeI=0,this.to=e[e.length-1].to,this.lineStart=this.absoluteLineStart=this.absoluteLineEnd=e[0].from,this.block=i.create(b.Document,0,this.lineStart,0,0),this.stack=[this.block],this.fragments=d.length?new ah(d,c):null,this.readLine()}get parsedPos(){return this.absoluteLineStart}advance(){if(null!=this.stoppedAt&&this.absoluteLineStart>this.stoppedAt)return this.finish();let{line:a}=this;for(;;){for(let b=0;;){let c=a.depth<this.stack.length?this.stack[this.stack.length-1]:null;for(;b<a.markers.length&&(!c||a.markers[b].from<c.end);){let c=a.markers[b++];this.addNode(c.type,c.from,c.to)}if(!c)break;this.finishContext()}if(a.pos<a.text.length)break;if(!this.nextLine())return this.finish()}if(this.fragments&&this.reuseFragment(a.basePos))return null;a:for(;;){for(let b of this.parser.blockParsers)if(b){let c=b(this,a);if(!1!=c){if(!0==c)return null;a.forward();continue a}}break}let b=new j(this.lineStart+a.pos,a.text.slice(a.pos));for(let a of this.parser.leafBlockParsers)if(a){let c=a(this,b);c&&b.parsers.push(c)}b:for(;this.nextLine()&&a.pos!=a.text.length;){if(a.indent<a.baseIndent+4){for(let c of this.parser.endLeafBlock)if(c(this,a,b))break b}for(let c of b.parsers)if(c.nextLine(this,a,b))return null;for(let c of(b.content+="\n"+a.scrub(),a.markers))b.marks.push(c)}return this.finishLeaf(b),null}stopAt(a){if(null!=this.stoppedAt&&this.stoppedAt<a)throw RangeError("Can't move stoppedAt forward");this.stoppedAt=a}reuseFragment(a){if(!this.fragments.moveTo(this.absoluteLineStart+a,this.absoluteLineStart)||!this.fragments.matches(this.block.hash))return!1;let b=this.fragments.takeNodes(this);return!!b&&(this.absoluteLineStart+=b,this.lineStart=ai(this.absoluteLineStart,this.ranges),this.moveRangeI(),this.absoluteLineStart<this.to?(this.lineStart++,this.absoluteLineStart++):this.atEnd=!0,this.readLine(),!0)}get depth(){return this.stack.length}parentType(a=this.depth-1){return this.parser.nodeSet.types[this.stack[a].type]}nextLine(){return(this.lineStart+=this.line.text.length,this.absoluteLineEnd>=this.to)?(this.absoluteLineStart=this.absoluteLineEnd,this.atEnd=!0,this.readLine(),!1):(this.lineStart++,this.absoluteLineStart=this.absoluteLineEnd+1,this.moveRangeI(),this.readLine(),!0)}peekLine(){return this.scanLine(this.absoluteLineEnd+1).text}moveRangeI(){for(;this.rangeI<this.ranges.length-1&&this.absoluteLineStart>=this.ranges[this.rangeI].to;)this.rangeI++,this.absoluteLineStart=Math.max(this.absoluteLineStart,this.ranges[this.rangeI].from)}scanLine(a){if(K.end=a,a>=this.to)K.text="";else if(K.text=this.lineChunkAt(a),K.end+=K.text.length,this.ranges.length>1){let a=this.absoluteLineStart,b=this.rangeI;for(;this.ranges[b].to<K.end;){b++;let c=this.ranges[b].from,d=this.lineChunkAt(c);K.end=c+d.length,K.text=K.text.slice(0,this.ranges[b-1].to-a)+d,a=K.end-K.text.length}}return K}readLine(){let{line:a}=this,{text:c,end:d}=this.scanLine(this.absoluteLineStart);for(this.absoluteLineEnd=d,a.reset(c);a.depth<this.stack.length;a.depth++){let c=this.stack[a.depth],d=this.parser.skipContextMarkup[c.type];if(!d)throw Error("Unhandled block context "+b[c.type]);if(!d(c,this,a))break;a.forward()}}lineChunkAt(a){let b=this.input.chunk(a),c;if(this.input.lineChunks)c="\n"==b?"":b;else{let a=b.indexOf("\n");c=a<0?b:b.slice(0,a)}return a+c.length>this.to?c.slice(0,this.to-a):c}prevLineEnd(){return this.atEnd?this.lineStart:this.lineStart-1}startContext(a,b,c=0){this.block=i.create(a,c,this.lineStart+b,this.block.hash,this.lineStart+this.line.text.length),this.stack.push(this.block)}startComposite(a,b,c=0){this.startContext(this.parser.getNodeType(a),b,c)}addNode(a,b,c){"number"==typeof a&&(a=new g.Tree(this.parser.nodeSet.types[a],Q,Q,(null!=c?c:this.prevLineEnd())-b)),this.block.addChild(a,b-this.block.from)}addElement(a){this.block.addChild(a.toTree(this.parser.nodeSet),a.from-this.block.from)}addLeafElement(a,b){this.addNode(this.buffer.writeElements(af(b.children,a.marks),-b.from).finish(b.type,b.to-b.from),b.from)}finishContext(){let a=this.stack.pop(),b=this.stack[this.stack.length-1];b.addChild(a.toTree(this.parser.nodeSet),a.from-b.from),this.block=b}finish(){for(;this.stack.length>1;)this.finishContext();return this.addGaps(this.block.toTree(this.parser.nodeSet,this.lineStart))}addGaps(a){return this.ranges.length>1?function a(b,c,d,e,f){let h=b[c].to,i=[],j=[],k=d.from+e;function l(a,d){for(;d?a>=h:a>h;){let d=b[c+1].from-h;e+=d,a+=d,h=b[++c].to}}for(let g=d.firstChild;g;g=g.nextSibling){l(g.from+e,!0);let d=g.from+e,m,n=f.get(g.tree);n?m=n:g.to+e>h?(m=a(b,c,g,e,f),l(g.to+e,!1)):m=g.toTree(),i.push(m),j.push(d-k)}return l(d.to+e,!1),new g.Tree(d.type,i,j,d.to+e-k,d.tree?d.tree.propValues:void 0)}(this.ranges,0,a.topNode,this.ranges[0].from,this.reusePlaceholders):a}finishLeaf(a){for(let b of a.parsers)if(b.finish(this,a))return;let c=af(this.parser.parseInline(a.content,a.start),a.marks);this.addNode(this.buffer.writeElements(c,-a.start).finish(b.Paragraph,a.content.length),a.start)}elt(a,b,c,d){return"string"==typeof a?U(this.parser.getNodeType(a),b,c,d):new T(a,b)}get buffer(){return new R(this.parser.nodeSet)}}class M extends g.Parser{constructor(a,b,c,d,e,f,g,h,i){for(let j of(super(),this.nodeSet=a,this.blockParsers=b,this.leafBlockParsers=c,this.blockNames=d,this.endLeafBlock=e,this.skipContextMarkup=f,this.inlineParsers=g,this.inlineNames=h,this.wrappers=i,this.nodeTypes=Object.create(null),a.types))this.nodeTypes[j.name]=j.id}createParse(a,b,c){let d=new L(this,a,b,c);for(let e of this.wrappers)d=e(d,a,b,c);return d}configure(a){let c=function a(b){if(!Array.isArray(b))return b;if(0==b.length)return null;let c=a(b[0]);if(1==b.length)return c;let d=a(b.slice(1));if(!d||!c)return c||d;let e=(a,b)=>(a||Q).concat(b||Q),f=c.wrap,g=d.wrap;return{props:e(c.props,d.props),defineNodes:e(c.defineNodes,d.defineNodes),parseBlock:e(c.parseBlock,d.parseBlock),parseInline:e(c.parseInline,d.parseInline),remove:e(c.remove,d.remove),wrap:f?g?(a,b,c,d)=>f(g(a,b,c,d),b,c,d):f:g}}(a);if(!c)return this;let{nodeSet:d,skipContextMarkup:e}=this,f=this.blockParsers.slice(),i=this.leafBlockParsers.slice(),j=this.blockNames.slice(),k=this.inlineParsers.slice(),l=this.inlineNames.slice(),m=this.endLeafBlock.slice(),n=this.wrappers;if(N(c.defineNodes)){e=Object.assign({},e);let a=d.types.slice(),f;for(let d of c.defineNodes){let{name:c,block:i,composite:j,style:k}="string"==typeof d?{name:d}:d;if(a.some(a=>a.name==c))continue;j&&(e[a.length]=(a,b,c)=>j(b,c,a.value));let l=a.length,m=j?["Block","BlockContext"]:i?l>=b.ATXHeading1&&l<=b.SetextHeading2?["Block","LeafBlock","Heading"]:["Block","LeafBlock"]:void 0;a.push(g.NodeType.define({id:l,name:c,props:m&&[[g.NodeProp.group,m]]})),k&&(f||(f={}),Array.isArray(k)||k instanceof h.Tag?f[c]=k:Object.assign(f,k))}d=new g.NodeSet(a),f&&(d=d.extend((0,h.styleTags)(f)))}if(N(c.props)&&(d=d.extend(...c.props)),N(c.remove))for(let a of c.remove){let b=this.blockNames.indexOf(a),c=this.inlineNames.indexOf(a);b>-1&&(f[b]=i[b]=void 0),c>-1&&(k[c]=void 0)}if(N(c.parseBlock))for(let a of c.parseBlock){let b=j.indexOf(a.name);if(b>-1)f[b]=a.parse,i[b]=a.leaf;else{let b=a.before?O(j,a.before):a.after?O(j,a.after)+1:j.length-1;f.splice(b,0,a.parse),i.splice(b,0,a.leaf),j.splice(b,0,a.name)}a.endLeaf&&m.push(a.endLeaf)}if(N(c.parseInline))for(let a of c.parseInline){let b=l.indexOf(a.name);if(b>-1)k[b]=a.parse;else{let b=a.before?O(l,a.before):a.after?O(l,a.after)+1:l.length-1;k.splice(b,0,a.parse),l.splice(b,0,a.name)}}return c.wrap&&(n=n.concat(c.wrap)),new M(d,f,i,j,m,e,k,l,n)}getNodeType(a){let b=this.nodeTypes[a];if(null==b)throw RangeError(`Unknown node type '${a}'`);return b}parseInline(a,b){let c=new ae(this,a,b);c:for(let a=b;a<c.end;){let b=c.char(a);for(let d of this.inlineParsers)if(d){let e=d(c,b,a);if(e>=0){a=e;continue c}}a++}return c.resolveMarkers(0)}}function N(a){return null!=a&&a.length>0}function O(a,b){let c=a.indexOf(b);if(c<0)throw RangeError(`Position specified relative to unknown parser ${b}`);return c}let P=[g.NodeType.none];for(let a=1,c;c=b[a];a++)P[a]=g.NodeType.define({id:a,name:c,props:a>=b.Escape?[]:[[g.NodeProp.group,a in m?["Block","BlockContext"]:["Block","LeafBlock"]]],top:"Document"==c});let Q=[];class R{constructor(a){this.nodeSet=a,this.content=[],this.nodes=[]}write(a,b,c,d=0){return this.content.push(a,b,c,4+4*d),this}writeElements(a,b=0){for(let c of a)c.writeTo(this,b);return this}finish(a,b){return g.Tree.build({buffer:this.content,nodeSet:this.nodeSet,reused:this.nodes,topID:a,length:b})}}class S{constructor(a,b,c,d=Q){this.type=a,this.from=b,this.to=c,this.children=d}writeTo(a,b){let c=a.content.length;a.writeElements(this.children,b),a.content.push(this.type,this.from+b,this.to+b,a.content.length+4-c)}toTree(a){return new R(a).writeElements(this.children,-this.from).finish(this.type,this.to-this.from)}}class T{constructor(a,b){this.tree=a,this.from=b}get to(){return this.from+this.tree.length}get type(){return this.tree.type.id}get children(){return Q}writeTo(a,b){a.nodes.push(this.tree),a.content.push(a.nodes.length-1,this.from+b,this.to+b,-1)}toTree(){return this.tree}}function U(a,b,c,d){return new S(a,b,c,d)}let V={resolve:"Emphasis",mark:"EmphasisMark"},W={resolve:"Emphasis",mark:"EmphasisMark"},X={},Y={};class Z{constructor(a,b,c,d){this.type=a,this.from=b,this.to=c,this.side=d}}let $="!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~",_=/[!"#$%&'()*+,\-.\/:;<=>?@\[\\\]^_`{|}~\xA1\u2010-\u2027]/;try{_=RegExp("[\\p{S}|\\p{P}]","u")}catch(a){}let aa={Escape(a,c,d){if(92!=c||d==a.end-1)return -1;let e=a.char(d+1);for(let c=0;c<$.length;c++)if($.charCodeAt(c)==e)return a.append(U(b.Escape,d,d+2));return -1},Entity(a,c,d){if(38!=c)return -1;let e=/^(?:#\d+|#x[a-f\d]+|\w+);/i.exec(a.slice(d+1,d+31));return e?a.append(U(b.Entity,d,d+1+e[0].length)):-1},InlineCode(a,c,d){if(96!=c||d&&96==a.char(d-1))return -1;let e=d+1;for(;e<a.end&&96==a.char(e);)e++;let f=e-d,g=0;for(;e<a.end;e++)if(96==a.char(e)){if(++g==f&&96!=a.char(e+1))return a.append(U(b.InlineCode,d,e+1,[U(b.CodeMark,d,d+f),U(b.CodeMark,e+1-f,e+1)]))}else g=0;return -1},HTMLTag(a,c,d){if(60!=c||d==a.end-1)return -1;let e=a.slice(d+1,a.end),f=/^(?:[a-z][-\w+.]+:[^\s>]+|[a-z\d.!#$%&'*+/=?^_`{|}~-]+@[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?(?:\.[a-z\d](?:[a-z\d-]{0,61}[a-z\d])?)*)>/i.exec(e);if(f)return a.append(U(b.Autolink,d,d+1+f[0].length,[U(b.LinkMark,d,d+1),U(b.URL,d+1,d+f[0].length),U(b.LinkMark,d+f[0].length,d+1+f[0].length)]));let g=/^!--[^>](?:-[^-]|[^-])*?-->/i.exec(e);if(g)return a.append(U(b.Comment,d,d+1+g[0].length));let h=/^\?[^]*?\?>/.exec(e);if(h)return a.append(U(b.ProcessingInstruction,d,d+1+h[0].length));let i=/^(?:![A-Z][^]*?>|!\[CDATA\[[^]*?\]\]>|\/\s*[a-zA-Z][\w-]*\s*>|\s*[a-zA-Z][\w-]*(\s+[a-zA-Z:_][\w-.:]*(?:\s*=\s*(?:[^\s"'=<>`]+|'[^']*'|"[^"]*"))?)*\s*(\/\s*)?>)/.exec(e);return i?a.append(U(b.HTMLTag,d,d+1+i[0].length)):-1},Emphasis(a,b,c){if(95!=b&&42!=b)return -1;let d=c+1;for(;a.char(d)==b;)d++;let e=a.slice(c-1,c),f=a.slice(d,d+1),g=_.test(e),h=_.test(f),i=/\s|^$/.test(e),j=/\s|^$/.test(f),k=!j&&(!h||i||g),l=!i&&(!g||j||h);return a.append(new Z(95==b?V:W,c,d,!!(k&&(42==b||!l||g))|2*!!(l&&(42==b||!k||h))))},HardBreak(a,c,d){if(92==c&&10==a.char(d+1))return a.append(U(b.HardBreak,d,d+2));if(32==c){let c=d+1;for(;32==a.char(c);)c++;if(10==a.char(c)&&c>=d+2)return a.append(U(b.HardBreak,d,c+1))}return -1},Link:(a,b,c)=>91==b?a.append(new Z(X,c,c+1,1)):-1,Image:(a,b,c)=>33==b&&91==a.char(c+1)?a.append(new Z(Y,c,c+2,1)):-1,LinkEnd(a,c,d){if(93!=c)return -1;for(let c=a.parts.length-1;c>=0;c--){let e=a.parts[c];if(e instanceof Z&&(e.type==X||e.type==Y)){if(!e.side||a.skipSpace(e.to)==d&&!/[(\[]/.test(a.slice(d+1,d+2)))return a.parts[c]=null,-1;let f=a.takeContent(c),g=a.parts[c]=function(a,c,d,e,f){let{text:g}=a,h=a.char(f),i=f;if(c.unshift(U(b.LinkMark,e,e+(d==b.Image?2:1))),c.push(U(b.LinkMark,f-1,f)),40==h){let d=a.skipSpace(f+1),e=ab(g,d-a.offset,a.offset),h;e&&(d=a.skipSpace(e.to))!=e.to&&(h=ac(g,d-a.offset,a.offset))&&(d=a.skipSpace(h.to)),41==a.char(d)&&(c.push(U(b.LinkMark,f,f+1)),i=d+1,e&&c.push(e),h&&c.push(h),c.push(U(b.LinkMark,d,i)))}else if(91==h){let b=ad(g,f-a.offset,a.offset,!1);b&&(c.push(b),i=b.to)}return U(d,e,i,c)}(a,f,e.type==X?b.Link:b.Image,e.from,d+1);if(e.type==X)for(let b=0;b<c;b++){let c=a.parts[b];c instanceof Z&&c.type==X&&(c.side=0)}return g.to}}return -1}};function ab(a,c,d){if(60==a.charCodeAt(c)){for(let e=c+1;e<a.length;e++){let f=a.charCodeAt(e);if(62==f)return U(b.URL,c+d,e+1+d);if(60==f||10==f)return!1}return null}{let e=0,f=c;for(let b=!1;f<a.length;f++){let c=a.charCodeAt(f);if(n(c))break;if(b)b=!1;else if(40==c)e++;else if(41==c){if(!e)break;e--}else 92==c&&(b=!0)}return f>c?U(b.URL,c+d,f+d):f==a.length&&null}}function ac(a,c,d){let e=a.charCodeAt(c);if(39!=e&&34!=e&&40!=e)return!1;let f=40==e?41:e;for(let e=c+1,g=!1;e<a.length;e++){let h=a.charCodeAt(e);if(g)g=!1;else{if(h==f)return U(b.LinkTitle,c+d,e+1+d);92==h&&(g=!0)}}return null}function ad(a,c,d,e){for(let f=!1,g=c+1,h=Math.min(a.length,g+999);g<h;g++){let h=a.charCodeAt(g);if(f)f=!1;else{if(93==h)return!e&&U(b.LinkLabel,c+d,g+1+d);if(e&&!n(h)&&(e=!1),91==h)return!1;92==h&&(f=!0)}}return null}class ae{constructor(a,b,c){this.parser=a,this.text=b,this.offset=c,this.parts=[]}char(a){return a>=this.end?-1:this.text.charCodeAt(a-this.offset)}get end(){return this.offset+this.text.length}slice(a,b){return this.text.slice(a-this.offset,b-this.offset)}append(a){return this.parts.push(a),a.to}addDelimiter(a,b,c,d,e){return this.append(new Z(a,b,c,!!d|2*!!e))}get hasOpenLink(){for(let a=this.parts.length-1;a>=0;a--){let b=this.parts[a];if(b instanceof Z&&(b.type==X||b.type==Y))return!0}return!1}addElement(a){return this.append(a)}resolveMarkers(a){for(let b=a;b<this.parts.length;b++){let c=this.parts[b];if(!(c instanceof Z&&c.type.resolve&&2&c.side))continue;let d=c.type==V||c.type==W,e=c.to-c.from,f,g=b-1;for(;g>=a;g--){let a=this.parts[g];if(a instanceof Z&&1&a.side&&a.type==c.type&&!(d&&(1&c.side||2&a.side)&&(a.to-a.from+e)%3==0&&((a.to-a.from)%3||e%3))){f=a;break}}if(!f)continue;let h=c.type.resolve,i=[],j=f.from,k=c.to;if(d){let a=Math.min(2,f.to-f.from,e);j=f.to-a,k=c.from+a,h=1==a?"Emphasis":"StrongEmphasis"}f.type.mark&&i.push(this.elt(f.type.mark,j,f.to));for(let a=g+1;a<b;a++)this.parts[a]instanceof S&&i.push(this.parts[a]),this.parts[a]=null;c.type.mark&&i.push(this.elt(c.type.mark,c.from,k));let l=this.elt(h,j,k,i);this.parts[g]=d&&f.from!=j?new Z(f.type,f.from,j,f.side):null,(this.parts[b]=d&&c.to!=k?new Z(c.type,k,c.to,c.side):null)?this.parts.splice(b,0,l):this.parts[b]=l}let b=[];for(let c=a;c<this.parts.length;c++){let a=this.parts[c];a instanceof S&&b.push(a)}return b}findOpeningDelimiter(a){for(let b=this.parts.length-1;b>=0;b--){let c=this.parts[b];if(c instanceof Z&&c.type==a)return b}return null}takeContent(a){let b=this.resolveMarkers(a);return this.parts.length=a,b}skipSpace(a){return o(this.text,a-this.offset)+this.offset}elt(a,b,c,d){return"string"==typeof a?U(this.parser.getNodeType(a),b,c,d):new T(a,b)}}function af(a,b){if(!b.length)return a;if(!a.length)return b;let c=a.slice(),d=0;for(let a of b){for(;d<c.length&&c[d].to<a.to;)d++;if(d<c.length&&c[d].from<a.from){let b=c[d];b instanceof S&&(c[d]=new S(b.type,b.from,b.to,af(b.children,[a])))}else c.splice(d++,0,a)}return c}let ag=[b.CodeBlock,b.ListItem,b.OrderedList,b.BulletList];class ah{constructor(a,b){this.fragments=a,this.input=b,this.i=0,this.fragment=null,this.fragmentEnd=-1,this.cursor=null,a.length&&(this.fragment=a[this.i++])}nextFragment(){this.fragment=this.i<this.fragments.length?this.fragments[this.i++]:null,this.cursor=null,this.fragmentEnd=-1}moveTo(a,b){for(;this.fragment&&this.fragment.to<=a;)this.nextFragment();if(!this.fragment||this.fragment.from>(a?a-1:0))return!1;if(this.fragmentEnd<0){let a=this.fragment.to;for(;a>0&&"\n"!=this.input.read(a-1,a);)a--;this.fragmentEnd=a?a-1:0}let c=this.cursor;c||(c=this.cursor=this.fragment.tree.cursor()).firstChild();let d=a+this.fragment.offset;for(;c.to<=d;)if(!c.parent())return!1;for(;;){if(c.from>=d)return this.fragment.from<=b;if(!c.childAfter(d))return!1}}matches(a){let b=this.cursor.tree;return b&&b.prop(g.NodeProp.contextHash)==a}takeNodes(a){let c=this.cursor,d=this.fragment.offset,e=this.fragmentEnd-!!this.fragment.openEnd,f=a.absoluteLineStart,h=f,i=a.block.children.length,j=h,k=i;for(;;){if(c.to-d>e){if(c.type.isAnonymous&&c.firstChild())continue;break}let f=ai(c.from-d,a.ranges);if(c.to-d<=a.ranges[a.rangeI].to)a.addNode(c.tree,f);else{let d=new g.Tree(a.parser.nodeSet.types[b.Paragraph],[],[],0,a.block.hashProp);a.reusePlaceholders.set(d,c.tree),a.addNode(d,f)}if(c.type.is("Block")&&(0>ag.indexOf(c.type.id)?(h=c.to-d,i=a.block.children.length):(h=j,i=k,j=c.to-d,k=a.block.children.length)),!c.nextSibling())break}for(;a.block.children.length>i;)a.block.children.pop(),a.block.positions.pop();return h-f}}function ai(a,b){let c=a;for(let d=1;d<b.length;d++){let e=b[d-1].to,f=b[d].from;e<a&&(c-=f-e)}return c}let aj=(0,h.styleTags)({"Blockquote/...":h.tags.quote,HorizontalRule:h.tags.contentSeparator,"ATXHeading1/... SetextHeading1/...":h.tags.heading1,"ATXHeading2/... SetextHeading2/...":h.tags.heading2,"ATXHeading3/...":h.tags.heading3,"ATXHeading4/...":h.tags.heading4,"ATXHeading5/...":h.tags.heading5,"ATXHeading6/...":h.tags.heading6,"Comment CommentBlock":h.tags.comment,Escape:h.tags.escape,Entity:h.tags.character,"Emphasis/...":h.tags.emphasis,"StrongEmphasis/...":h.tags.strong,"Link/... Image/...":h.tags.link,"OrderedList/... BulletList/...":h.tags.list,"BlockQuote/...":h.tags.quote,"InlineCode CodeText":h.tags.monospace,"URL Autolink":h.tags.url,"HeaderMark HardBreak QuoteMark ListMark LinkMark EmphasisMark CodeMark":h.tags.processingInstruction,"CodeInfo LinkLabel":h.tags.labelName,LinkTitle:h.tags.string,Paragraph:h.tags.content}),ak=new M(new g.NodeSet(P).extend(aj),Object.keys(F).map(a=>F[a]),Object.keys(F).map(a=>J[a]),Object.keys(F),[(a,b)=>w(b)>=0,(a,b)=>q(b)>=0,(a,b)=>r(b)>=0,(a,b)=>u(b,a,!0)>=0,(a,b)=>v(b,a,!0)>=0,(a,b)=>s(b,a,!0)>=0,(a,b)=>C(b,a,!0)>=0],m,Object.keys(aa).map(a=>aa[a]),Object.keys(aa),[]),al={resolve:"Strikethrough",mark:"StrikethroughMark"},am={defineNodes:[{name:"Strikethrough",style:{"Strikethrough/...":h.tags.strikethrough}},{name:"StrikethroughMark",style:h.tags.processingInstruction}],parseInline:[{name:"Strikethrough",parse(a,b,c){if(126!=b||126!=a.char(c+1)||126==a.char(c+2))return -1;let d=a.slice(c-1,c),e=a.slice(c+2,c+3),f=/\s|^$/.test(d),g=/\s|^$/.test(e),h=_.test(d),i=_.test(e);return a.addDelimiter(al,c,c+2,!g&&(!i||f||h),!f&&(!h||g||i))},after:"Emphasis"}]};function an(a,b,c=0,d,e=0){let f=0,g=!0,h=-1,i=-1,j=!1,k=()=>{d.push(a.elt("TableCell",e+h,e+i,a.parser.parseInline(b.slice(h,i),e+h)))};for(let l=c;l<b.length;l++){let c=b.charCodeAt(l);124!=c||j?(j||32!=c&&9!=c)&&(h<0&&(h=l),i=l+1):((!g||h>-1)&&f++,g=!1,d&&(h>-1&&k(),d.push(a.elt("TableDelimiter",l+e,l+e+1))),h=i=-1),j=!j&&92==c}return h>-1&&(f++,d&&k()),f}function ao(a,b){for(let c=b;c<a.length;c++){let b=a.charCodeAt(c);if(124==b)return!0;92==b&&c++}return!1}let ap=/^\|?(\s*:?-+:?\s*\|)+(\s*:?-+:?\s*)?$/;class aq{constructor(){this.rows=null}nextLine(a,b,c){if(null==this.rows){let d;if(this.rows=!1,(45==b.next||58==b.next||124==b.next)&&ap.test(d=b.text.slice(b.pos))){let e=[];an(a,c.content,0,e,c.start)==an(a,d,b.pos)&&(this.rows=[a.elt("TableHeader",c.start,c.start+c.content.length,e),a.elt("TableDelimiter",a.lineStart+b.pos,a.lineStart+b.text.length)])}}else if(this.rows){let c=[];an(a,b.text,b.pos,c,a.lineStart),this.rows.push(a.elt("TableRow",a.lineStart+b.pos,a.lineStart+b.text.length,c))}return!1}finish(a,b){return!!this.rows&&(a.addLeafElement(b,a.elt("Table",b.start,b.start+b.content.length,this.rows)),!0)}}let ar={defineNodes:[{name:"Table",block:!0},{name:"TableHeader",style:{"TableHeader/...":h.tags.heading}},"TableRow",{name:"TableCell",style:h.tags.content},{name:"TableDelimiter",style:h.tags.processingInstruction}],parseBlock:[{name:"Table",leaf:(a,b)=>ao(b.content,0)?new aq:null,endLeaf(a,b,c){if(c.parsers.some(a=>a instanceof aq)||!ao(b.text,b.basePos))return!1;let d=a.peekLine();return ap.test(d)&&an(a,b.text,b.basePos)==an(a,d,b.basePos)},before:"SetextHeading"}]};class as{nextLine(){return!1}finish(a,b){return a.addLeafElement(b,a.elt("Task",b.start,b.start+b.content.length,[a.elt("TaskMarker",b.start,b.start+3),...a.parser.parseInline(b.content.slice(3),b.start+3)])),!0}}let at={defineNodes:[{name:"Task",block:!0,style:h.tags.list},{name:"TaskMarker",style:h.tags.atom}],parseBlock:[{name:"TaskList",leaf:(a,b)=>/^\[[ xX]\][ \t]/.test(b.content)&&"ListItem"==a.parentType().name?new as:null,after:"SetextHeading"}]},au=/(www\.)|(https?:\/\/)|([\w.+-]{1,100}@)|(mailto:|xmpp:)/gy,av=/[\w-]+(\.[\w-]+)+(\/[^\s<]*)?/gy,aw=/[\w-]+\.[\w-]+($|\/)/,ax=/[\w.+-]+@[\w-]+(\.[\w.-]+)+/gy,ay=/\/[a-zA-Z\d@.]+/gy;function az(a,b,c,d){let e=0;for(let f=b;f<c;f++)a[f]==d&&e++;return e}function aA(a,b){ax.lastIndex=b;let c=ax.exec(a);if(!c)return -1;let d=c[0][c[0].length-1];return"_"==d||"-"==d?-1:b+c[0].length-("."==d)}let aB=[ar,at,am,{parseInline:[{name:"Autolink",parse(a,b,c){let d=c-a.offset;if(d&&/\w/.test(a.text[d-1]))return -1;au.lastIndex=d;let e=au.exec(a.text),f=-1;if(!e)return -1;if(e[1]||e[2]){if((f=function(a,b){av.lastIndex=b;let c=av.exec(a);if(!c||aw.exec(c[0])[0].indexOf("_")>-1)return -1;let d=b+c[0].length;for(;;){let c=a[d-1],e;if(/[?!.,:*_~]/.test(c)||")"==c&&az(a,b,d,")")>az(a,b,d,"("))d--;else if(";"==c&&(e=/&(?:#\d+|#x[a-f\d]+|\w+);$/.exec(a.slice(b,d))))d=b+e.index;else break}return d}(a.text,d+e[0].length))>-1&&a.hasOpenLink){let b=/([^\[\]]|\[[^\]]*\])*/.exec(a.text.slice(d,f));f=d+b[0].length}}else e[3]?f=aA(a.text,d):(f=aA(a.text,d+e[0].length))>-1&&"xmpp:"==e[0]&&(ay.lastIndex=f,(e=ay.exec(a.text))&&(f=e.index+e[0].length));return f<0?-1:(a.addElement(a.elt("URL",c,f+a.offset)),f+a.offset)}}]}];function aC(a,b,c){return(d,e,f)=>{if(e!=a||d.char(f+1)==a)return -1;let g=[d.elt(c,f,f+1)];for(let e=f+1;e<d.end;e++){let h=d.char(e);if(h==a)return d.addElement(d.elt(b,f,e+1,g.concat(d.elt(c,e,e+1))));if(92==h&&g.push(d.elt("Escape",e,e+++2)),n(h))break}return -1}}let aD={defineNodes:[{name:"Superscript",style:h.tags.special(h.tags.content)},{name:"SuperscriptMark",style:h.tags.processingInstruction}],parseInline:[{name:"Superscript",parse:aC(94,"Superscript","SuperscriptMark")}]},aE={defineNodes:[{name:"Subscript",style:h.tags.special(h.tags.content)},{name:"SubscriptMark",style:h.tags.processingInstruction}],parseInline:[{name:"Subscript",parse:aC(126,"Subscript","SubscriptMark")}]},aF={defineNodes:[{name:"Emoji",style:h.tags.character}],parseInline:[{name:"Emoji",parse(a,b,c){let d;return 58==b&&(d=/^[a-zA-Z_0-9]+:/.exec(a.slice(c+1,a.end)))?a.addElement(a.elt("Emoji",c,c+1+d[0].length)):-1}}]};var aG=a.i(379330);let aH=(0,e.defineLanguageFacet)({commentTokens:{block:{open:"<!--",close:"-->"}}}),aI=new g.NodeProp,aJ=ak.configure({props:[e.foldNodeProp.add(a=>!a.is("Block")||a.is("Document")||null!=aK(a)||function(a){return"OrderedList"==a.name||"BulletList"==a.name}(a)?void 0:(a,b)=>({from:b.doc.lineAt(a.from).to,to:a.to})),aI.add(aK),e.indentNodeProp.add({Document:()=>null}),e.languageDataProp.add({Document:aH})]});function aK(a){let b=/^(?:ATX|Setext)Heading(\d)$/.exec(a.name);return b?+b[1]:void 0}let aL=e.foldService.of((a,b,c)=>{for(let d=(0,e.syntaxTree)(a).resolveInner(c,-1);d&&!(d.from<b);d=d.parent){let a=d.type.prop(aI);if(null==a)continue;let b=function(a,b){let c=a;for(;;){let a=c.nextSibling,d;if(!a||null!=(d=aK(a.type))&&d<=b)break;c=a}return c.to}(d,a);if(b>c)return{from:c,to:b}}return null});function aM(a){return new e.Language(aH,a,[],"markdown")}let aN=aM(aJ),aO=aM(aJ.configure([aB,aE,aD,aF,{props:[e.foldNodeProp.add({Table:(a,b)=>({from:b.doc.lineAt(a.from).to,to:a.to})})]}]));class aP{constructor(a,b,c,d,e,f,g){this.node=a,this.from=b,this.to=c,this.spaceBefore=d,this.spaceAfter=e,this.type=f,this.item=g}blank(a,b=!0){let c=this.spaceBefore+("Blockquote"==this.node.name?">":"");if(null!=a){for(;c.length<a;)c+=" ";return c}for(let a=this.to-this.from-c.length-this.spaceAfter.length;a>0;a--)c+=" ";return c+(b?this.spaceAfter:"")}marker(a,b){let c="OrderedList"==this.node.name?String(+aR(this.item,a)[2]+b):"";return this.spaceBefore+c+this.type+this.spaceAfter}}function aQ(a,b){let c=[],d=[];for(let b=a;b;b=b.parent){if("FencedCode"==b.name)return d;("ListItem"==b.name||"Blockquote"==b.name)&&c.push(b)}for(let a=c.length-1;a>=0;a--){let e=c[a],f,g=b.lineAt(e.from),h=e.from-g.from;if("Blockquote"==e.name&&(f=/^ *>( ?)/.exec(g.text.slice(h))))d.push(new aP(e,h,h+f[0].length,"",f[1],">",null));else if("ListItem"==e.name&&"OrderedList"==e.parent.name&&(f=/^( *)\d+([.)])( *)/.exec(g.text.slice(h)))){let a=f[3],b=f[0].length;a.length>=4&&(a=a.slice(0,a.length-4),b-=4),d.push(new aP(e.parent,h,h+b,f[1],a,f[2],e))}else if("ListItem"==e.name&&"BulletList"==e.parent.name&&(f=/^( *)([-+*])( {1,4}\[[ xX]\])?( +)/.exec(g.text.slice(h)))){let a=f[4],b=f[0].length;a.length>4&&(a=a.slice(0,a.length-4),b-=4);let c=f[2];f[3]&&(c+=f[3].replace(/[xX]/," ")),d.push(new aP(e.parent,h,h+b,f[1],a,c,e))}}return d}function aR(a,b){return/^(\s*)(\d+)(?=[.)])/.exec(b.sliceString(a.from,a.from+10))}function aS(a,b,c,d=0){for(let e=-1,f=a;;){if("ListItem"==f.name){let a=aR(f,b),g=+a[2];if(e>=0){if(g!=e+1)return;c.push({from:f.from+a[1].length,to:f.from+a[0].length,insert:String(e+2+d)})}e=g}let a=f.nextSibling;if(!a)break;f=a}}function aT(a,b){let d=/^[ \t]*/.exec(a)[0].length;if(!d||"	"!=b.facet(e.indentUnit))return a;let f=(0,c.countColumn)(a,4,d),g="";for(let a=f;a>0;)a>=4?(g+="	",a-=4):(g+=" ",a--);return g+a.slice(d)}let aU=({state:a,dispatch:b})=>{let d=(0,e.syntaxTree)(a),{doc:f}=a,g=null,h=a.changeByRange(b=>{if(!b.empty||!aO.isActiveAt(a,b.from,-1)&&!aO.isActiveAt(a,b.from,1))return g={range:b};let e=b.from,h=f.lineAt(e),i=aQ(d.resolveInner(e,-1),f);for(;i.length&&i[i.length-1].from>e-h.from;)i.pop();if(!i.length)return g={range:b};let j=i[i.length-1];if(j.to-j.spaceAfter.length>e-h.from)return g={range:b};let k=e>=j.to-j.spaceAfter.length&&!/\S/.test(h.text.slice(j.to));if(j.item&&k){let b=j.node.firstChild,d=j.node.getChild("ListItem","ListItem");if(b.to>=e||d&&d.to<e||h.from>0&&!/[^\s>]/.test(f.lineAt(h.from-1).text)){let a=i.length>1?i[i.length-2]:null,b,d="";a&&a.item?(b=h.from+a.from,d=a.marker(f,1)):b=h.from+(a?a.to:0);let g=[{from:b,to:e,insert:d}];return"OrderedList"==j.node.name&&aS(j.item,f,g,-2),a&&"OrderedList"==a.node.name&&aS(a.item,f,g),{range:c.EditorSelection.cursor(b+d.length),changes:g}}{let b=aW(i,a,h);return{range:c.EditorSelection.cursor(e+b.length+1),changes:{from:h.from,insert:b+a.lineBreak}}}}if("Blockquote"==j.node.name&&k&&h.from){let c=f.lineAt(h.from-1),d=/>\s*$/.exec(c.text);if(d&&d.index==j.from){let e=a.changes([{from:c.from+d.index,to:c.to},{from:h.from+j.from,to:h.to}]);return{range:b.map(e),changes:e}}}let l=[];"OrderedList"==j.node.name&&aS(j.item,f,l);let m=j.item&&j.item.from<h.from,n="";if(!m||/^[\s\d.)\-+*>]*/.exec(h.text)[0].length>=j.to)for(let a=0,b=i.length-1;a<=b;a++)n+=a!=b||m?i[a].blank(a<b?(0,c.countColumn)(h.text,4,i[a+1].from)-n.length:null):i[a].marker(f,1);let o=e;for(;o>h.from&&/\s/.test(h.text.charAt(o-h.from-1));)o--;return n=aT(n,a),function(a,b){if("OrderedList"!=a.name&&"BulletList"!=a.name)return!1;let c=a.firstChild,d=a.getChild("ListItem","ListItem");if(!d)return!1;let e=b.lineAt(c.to),f=b.lineAt(d.from),g=/^[\s>]*$/.test(e.text);return e.number+ +!g<f.number}(j.node,a.doc)&&(n=aW(i,a,h)+a.lineBreak+n),l.push({from:o,to:e,insert:a.lineBreak+n}),{range:c.EditorSelection.cursor(o+n.length+1),changes:l}});return!g&&(b(a.update(h,{scrollIntoView:!0,userEvent:"input"})),!0)};function aV(a){return"QuoteMark"==a.name||"ListMark"==a.name}function aW(a,b,d){let e="";for(let b=0,f=a.length-2;b<=f;b++)e+=a[b].blank(b<f?(0,c.countColumn)(d.text,4,a[b+1].from)-e.length:null,b<f);return aT(e,b)}let aX=({state:a,dispatch:b})=>{let d=(0,e.syntaxTree)(a),f=null,g=a.changeByRange(b=>{let e=b.from,{doc:g}=a;if(b.empty&&aO.isActiveAt(a,b.from)){let b=g.lineAt(e),f=aQ(function(a,b){let c=a.resolveInner(b,-1),d=b;aV(c)&&(d=c.from,c=c.parent);for(let a;a=c.childBefore(d);)if(aV(a))d=a.from;else if("OrderedList"==a.name||"BulletList"==a.name)d=(c=a.lastChild).to;else break;return c}(d,e),g);if(f.length){let d=f[f.length-1],g=d.to-d.spaceAfter.length+ +!!d.spaceAfter;if(e-b.from>g&&!/\S/.test(b.text.slice(g,e-b.from)))return{range:c.EditorSelection.cursor(b.from+g),changes:{from:b.from+g,to:e}};if(e-b.from==g&&(!d.item||b.from<=d.item.from||!/\S/.test(b.text.slice(0,d.to)))){let f=b.from+d.from;if(d.item&&d.node.from<d.item.from&&/\S/.test(b.text.slice(d.from,d.to))){let e=d.blank((0,c.countColumn)(b.text,4,d.to)-(0,c.countColumn)(b.text,4,d.from));return f==b.from&&(e=aT(e,a)),{range:c.EditorSelection.cursor(f+e.length),changes:{from:f,to:b.from+d.to,insert:e}}}if(f<e)return{range:c.EditorSelection.cursor(f),changes:{from:f,to:e}}}}}return f={range:b}});return!f&&(b(a.update(g,{scrollIntoView:!0,userEvent:"delete"})),!0)},aY=[{key:"Enter",run:aU},{key:"Backspace",run:aX}],aZ=(0,aG.html)({matchClosingTags:!1});function a$(a={}){var f;let{codeLanguages:h,defaultCodeLanguage:i,addKeymap:j=!0,base:{parser:k}=aN,completeHTMLTags:l=!0,htmlTagLanguage:m=aZ}=a;if(!(k instanceof M))throw RangeError("Base parser provided to `markdown` should be a Markdown parser");let n=a.extensions?[a.extensions]:[],o=[m.support,aL],p;i instanceof e.LanguageSupport?(o.push(i.support),p=i.language):i&&(p=i);let q=h||p?(f=p,a=>{if(a&&h){let b=null;if(a=/\S*/.exec(a)[0],(b="function"==typeof h?h(a):e.LanguageDescription.matchLanguageName(h,a,!0))instanceof e.LanguageDescription)return b.support?b.support.language.parser:e.ParseContext.getSkippingParser(b.load());if(b)return b.parser}return f?f.parser:null}):void 0;n.push(function(a){let{codeParser:c,htmlParser:d}=a;return{wrap:(0,g.parseMixed)((a,e)=>{let f=a.type.id;if(c&&(f==b.CodeBlock||f==b.FencedCode)){let d="";if(f==b.FencedCode){let c=a.node.getChild(b.CodeInfo);c&&(d=e.read(c.from,c.to))}let g=c(d);if(g)return{parser:g,overlay:a=>a.type.id==b.CodeText}}else if(d&&(f==b.HTMLBlock||f==b.HTMLTag||f==b.CommentBlock))return{parser:d,overlay:function(a,b,c){let d=[];for(let e=a.firstChild,f=b;;e=e.nextSibling){let a=e?e.from:c;if(a>f&&d.push({from:f,to:a}),!e)break;f=e.to}return d}(a.node,a.from,a.to)};return null})}}({codeParser:q,htmlParser:m.language.parser})),j&&o.push(c.Prec.high(d.keymap.of(aY)));let r=aM(k.configure(n));return l&&o.push(r.data.of({autocomplete:a_})),new e.LanguageSupport(r,o)}function a_(a){let{state:b,pos:d}=a,g=/<[:\-\.\w\u00b7-\uffff]*$/.exec(b.sliceDoc(d-25,d));if(!g)return null;let h=(0,e.syntaxTree)(b).resolveInner(d,-1);for(;h&&!h.type.isTop;){if("CodeBlock"==h.name||"FencedCode"==h.name||"ProcessingInstructionBlock"==h.name||"CommentBlock"==h.name||"Link"==h.name||"Image"==h.name)return null;h=h.parent}return{from:d-g[0].length,to:d,options:function(){if(a0)return a0;let a=(0,aG.htmlCompletionSource)(new f.CompletionContext(c.EditorState.create({extensions:aZ}),0,!0));return a0=a?a.options:[]}(),validFor:/^<[:\-\.\w\u00b7-\uffff]*$/}}let a0=null}];

//# sourceMappingURL=aaaa8_%40codemirror_lang-markdown_dist_index_7e492398.js.map